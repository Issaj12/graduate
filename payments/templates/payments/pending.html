{% extends 'main_footer.html' %} {% block content %}

<div class="payment-status pending">
  <h2>Payment Pending</h2>
  <span class="status-icon">‚è≥</span>
  <p class="status-text">
    Transaction ID: <strong>{{ transaction.transaction_id }}</strong>
  </p>
    <p>Status: <span id="status">{{ transaction.status }}</span></p>
  <p>Please complete the payment on your phone.</p>
</div>

<script>
async function checkStatus() {
    let transactionId = "{{ transaction.id }}";
    let res = await fetch(`/payments/status/${transactionId}/`);
    let data = await res.json();
    document.getElementById("status").innerText = data.status;

    if (data.status === "Pending") {
        setTimeout(checkStatus, 3000); // poll every 3 seconds
    } else if (data.status === "Success") {
        // redirect to payment form or success page
        window.location.href = "{% url 'initiate_payment' %}";
    } else if (data.status === "Failed") {
        // optionally redirect to a failed page
        window.location.href = "{% url 'initiate_payment' %}";
    }
}

checkStatus();
</script>
{% endblock %}





